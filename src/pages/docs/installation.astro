---
import DocsLayout from '../../layouts/DocsLayout.astro'
import CodeBlock from '../../components/CodeBlock.astro'
---

<DocsLayout title="Installation">
  <h1>Installation</h1>

  <p class="lead text-xl text-neutral-600">
    Deploy Ender on your own server for production use.
  </p>

  <div class="not-prose my-6 alert alert-info">
    <p>
      <strong>Don't want to self-host?</strong> Try <a href="https://app.ender.town">Ender Cloud</a> â€” free plan available, paid plans from $0.99/month.
    </p>
  </div>

  <h2>Requirements</h2>

  <ul>
    <li>Linux server (Ubuntu 22.04+ recommended)</li>
    <li>Docker and Docker Compose v2</li>
    <li>At least 1GB RAM, 10GB disk</li>
    <li>Domain name with SSL certificate</li>
  </ul>

  <h2>Docker Compose (Recommended)</h2>

  <h3>1. Create docker-compose.yml</h3>

  <p>Create a new directory and add a <code>docker-compose.yml</code> file:</p>

  <CodeBlock
    lang="yaml"
    filename="docker-compose.yml"
    code={`services:
  backend:
    image: ghcr.io/ender-sms/backend:latest
    environment:
      - DATABASE_URL=postgresql://postgres:\${POSTGRES_PASSWORD}@db:5432/ender
      - SECRET_KEY=\${SECRET_KEY}
      - DOMAIN=\${DOMAIN}
    ports:
      - "8000:8000"
    depends_on:
      - db

  frontend:
    image: ghcr.io/ender-sms/frontend:latest
    environment:
      - VITE_API_URL=https://\${DOMAIN}
    ports:
      - "5173:80"

  db:
    image: postgres:17
    environment:
      - POSTGRES_DB=ender
      - POSTGRES_PASSWORD=\${POSTGRES_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:`}
  />

  <h3>2. Configure environment</h3>

  <p>Create a <code>.env</code> file in the same directory:</p>

  <CodeBlock
    lang="bash"
    filename=".env"
    code={`# Required
SECRET_KEY=your-32-character-secret-key
POSTGRES_PASSWORD=your-database-password
DOMAIN=sms.yourdomain.com`}
  />

  <h3>3. Start the services</h3>

  <CodeBlock lang="bash" code="docker compose up -d" />

  <h3>4. Register your account</h3>

  <p>Open the dashboard at <code>http://localhost:5173</code> (or your domain) and create your account. The first registered user becomes the admin.</p>

  <h2>Reverse Proxy Setup</h2>

  <p>See <a href="/docs/guides/nginx">Nginx Reverse Proxy</a> for SSL termination and proxy configuration.</p>

  <h2>Environment Variables</h2>

  <table>
    <thead>
      <tr>
        <th>Variable</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>SECRET_KEY</code></td>
        <td>JWT signing key (required)</td>
        <td>-</td>
      </tr>
      <tr>
        <td><code>DATABASE_URL</code></td>
        <td>PostgreSQL connection string</td>
        <td>postgres://...</td>
      </tr>
      <tr>
        <td><code>DOMAIN</code></td>
        <td>Your domain name</td>
        <td>localhost</td>
      </tr>
      <tr>
        <td><code>CORS_ORIGINS</code></td>
        <td>Allowed CORS origins</td>
        <td>*</td>
      </tr>
    </tbody>
  </table>

  <h2>Updates</h2>

  <p>To update to the latest version:</p>

  <CodeBlock
    lang="bash"
    code={`docker compose pull
docker compose up -d`}
  />

  <h2>Next steps</h2>

  <ul>
    <li><a href="/docs/android-app">Android App</a> - Set up your first device</li>
    <li><a href="/docs/guides/nginx">Nginx Guide</a> - Configure SSL</li>
    <li><a href="/docs/guides/docker">Docker Guide</a> - Advanced configuration</li>
  </ul>
</DocsLayout>
