---
import DocsLayout from '../../../layouts/DocsLayout.astro'
import CodeBlock from '../../../components/CodeBlock.astro'
---

<DocsLayout title="Send SMS">
  <h1>Send SMS</h1>

  <p class="lead text-xl text-neutral-600">
    Send an SMS message through the Ender API.
  </p>

  <div class="not-prose my-6 p-4 bg-neutral-100 rounded-lg">
    <p class="text-sm font-mono">
      <span class="text-green-600 font-semibold">POST</span>
      <span class="text-neutral-900 ml-2">/api/sms/send</span>
    </p>
  </div>

  <h2>Request</h2>

  <h3>Headers</h3>

  <table>
    <thead>
      <tr>
        <th>Header</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>X-API-Key</code></td>
        <td><code>YOUR_API_KEY</code></td>
      </tr>
      <tr>
        <td><code>Content-Type</code></td>
        <td><code>application/json</code></td>
      </tr>
    </tbody>
  </table>

  <p>Alternatively, you can use JWT authentication with <code>Authorization: Bearer YOUR_JWT_TOKEN</code>.</p>

  <h3>Body</h3>

  <table>
    <thead>
      <tr>
        <th>Field</th>
        <th>Type</th>
        <th>Required</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>recipients</code></td>
        <td>string[]</td>
        <td>Yes</td>
        <td>Array of phone numbers in E.164 format (e.g., <code>["+1234567890"]</code>)</td>
      </tr>
      <tr>
        <td><code>body</code></td>
        <td>string</td>
        <td>Yes</td>
        <td>Message content (max 1600 characters)</td>
      </tr>
      <tr>
        <td><code>device_id</code></td>
        <td>string</td>
        <td>No</td>
        <td>Specific device to use. If omitted, auto-selected via round-robin.</td>
      </tr>
    </tbody>
  </table>

  <h3>Example</h3>

  <CodeBlock
    lang="bash"
    code={`curl -X POST https://your-server.com/api/sms/send \\
  -H "X-API-Key: ek_your_api_key" \\
  -H "Content-Type: application/json" \\
  -d '{
    "recipients": ["+1234567890"],
    "body": "Your verification code is 123456"
  }'`}
  />

  <h2>Response</h2>

  <h3>Success (200 OK)</h3>

  <CodeBlock
    lang="json"
    code={`{
  "message_ids": ["a1b2c3d4e5f6g7h"],
  "recipients_count": 1,
  "status": "accepted"
}`}
  />

  <p>For multiple recipients, a <code>batch_id</code> field is also included:</p>

  <CodeBlock
    lang="json"
    code={`{
  "batch_id": "x9y8z7w6v5u4t3s",
  "message_ids": ["a1b2c3d4e5f", "g7h8i9j0k1l"],
  "recipients_count": 2,
  "status": "accepted"
}`}
  />

  <h3>Message statuses</h3>

  <table>
    <thead>
      <tr>
        <th>Status</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>pending</code></td>
        <td>Message created, no device assigned yet</td>
      </tr>
      <tr>
        <td><code>assigned</code></td>
        <td>Device assigned, push notification being sent</td>
      </tr>
      <tr>
        <td><code>sending</code></td>
        <td>Device is sending the message</td>
      </tr>
      <tr>
        <td><code>sent</code></td>
        <td>Message was sent successfully</td>
      </tr>
      <tr>
        <td><code>delivered</code></td>
        <td>Message was delivered (if delivery reports enabled)</td>
      </tr>
      <tr>
        <td><code>failed</code></td>
        <td>Message failed to send</td>
      </tr>
    </tbody>
  </table>

  <h3>Errors</h3>

  <CodeBlock
    lang="json"
    code={`// 400 Bad Request - Invalid phone number
{
  "error": "invalid_phone_number",
  "message": "Phone number must be in E.164 format"
}

// 401 Unauthorized - Invalid API key
{
  "error": "unauthorized",
  "message": "Authentication required"
}

// 402 Payment Required - Quota exceeded
{
  "error": "quota_exceeded",
  "message": "Monthly message quota exceeded"
}

// 503 Service Unavailable - No devices available
{
  "error": "no_devices",
  "message": "No devices available to send messages"
}`}
  />

  <h2>Code examples</h2>

  <h3>Python</h3>

  <CodeBlock
    lang="python"
    code={`import requests

response = requests.post(
    "https://your-server.com/api/sms/send",
    headers={
        "X-API-Key": "ek_your_api_key",
        "Content-Type": "application/json"
    },
    json={
        "recipients": ["+1234567890"],
        "body": "Hello from Python!"
    }
)

print(response.json())`}
  />

  <h3>JavaScript</h3>

  <CodeBlock
    lang="javascript"
    code={`const response = await fetch("https://your-server.com/api/sms/send", {
  method: "POST",
  headers: {
    "X-API-Key": "ek_your_api_key",
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    recipients: ["+1234567890"],
    body: "Hello from JavaScript!"
  })
});

const data = await response.json();
console.log(data);`}
  />

  <h2>Related</h2>

  <ul>
    <li><a href="/docs/api/status">Message Status</a> - Check delivery status</li>
    <li><a href="/docs/api/webhooks">Webhooks</a> - Receive delivery notifications</li>
    <li><a href="/docs/api/auth">Authentication</a> - API key management</li>
  </ul>
</DocsLayout>
