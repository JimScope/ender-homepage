---
import DocsLayout from '../../../layouts/DocsLayout.astro'
---

<DocsLayout title="Nginx Reverse Proxy">
  <h1>Nginx Reverse Proxy</h1>

  <p class="lead text-xl text-neutral-600">
    Set up Nginx with SSL for production.
  </p>

  <h2>Install Nginx</h2>

  <pre><code class="language-bash">sudo apt update
sudo apt install nginx</code></pre>

  <h2>Configure site</h2>

  <p>Create <code>/etc/nginx/sites-available/ender</code>:</p>

  <pre><code class="language-nginx">server {"{"}
    listen 80;
    server_name sms.yourdomain.com;
    return 301 https://$host$request_uri;
{"}"}

server {"{"}
    listen 443 ssl http2;
    server_name sms.yourdomain.com;

    ssl_certificate /etc/letsencrypt/live/sms.yourdomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/sms.yourdomain.com/privkey.pem;

    # API
    location /api {"{"}
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    {"}"}

    # Dashboard
    location / {"{"}
        proxy_pass http://localhost:5173;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    {"}"}
{"}"}</code></pre>

  <h2>Enable site</h2>

  <pre><code class="language-bash">sudo ln -s /etc/nginx/sites-available/ender /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx</code></pre>

  <h2>SSL with Certbot</h2>

  <pre><code class="language-bash">sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d sms.yourdomain.com</code></pre>

  <h2>Related</h2>

  <ul>
    <li><a href="/docs/installation">Installation</a> - Full setup guide</li>
    <li><a href="/docs/guides/docker">Docker Guide</a> - Container setup</li>
  </ul>
</DocsLayout>
