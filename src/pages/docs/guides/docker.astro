---
import DocsLayout from '../../../layouts/DocsLayout.astro'
import CodeBlock from '../../../components/CodeBlock.astro'
---

<DocsLayout title="Docker Deployment">
  <h1>Docker Deployment</h1>

  <p class="lead text-xl text-neutral-600">
    Deploy Ender using Docker Compose.
  </p>

  <h2>docker-compose.yml</h2>

  <CodeBlock
    lang="yaml"
    filename="docker-compose.yml"
    code={`services:
  backend:
    image: ghcr.io/ender-sms/backend:latest
    environment:
      - DATABASE_URL=postgresql://postgres:\${POSTGRES_PASSWORD}@db:5432/ender
      - SECRET_KEY=\${SECRET_KEY}
      - DOMAIN=\${DOMAIN}
    ports:
      - "8000:8000"
    depends_on:
      - db

  frontend:
    image: ghcr.io/ender-sms/frontend:latest
    environment:
      - VITE_API_URL=https://\${DOMAIN}
    ports:
      - "5173:80"

  db:
    image: postgres:17
    environment:
      - POSTGRES_DB=ender
      - POSTGRES_PASSWORD=\${POSTGRES_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:`}
  />

  <h2>Environment variables</h2>

  <p>Create a <code>.env</code> file:</p>

  <CodeBlock
    lang="bash"
    filename=".env"
    code={`SECRET_KEY=your-32-character-secret-key
POSTGRES_PASSWORD=your-database-password
DOMAIN=sms.yourdomain.com`}
  />

  <h2>Start services</h2>

  <CodeBlock lang="bash" code="docker compose up -d" />

  <h2>View logs</h2>

  <CodeBlock lang="bash" code="docker compose logs -f backend" />

  <h2>Update</h2>

  <CodeBlock
    lang="bash"
    code={`docker compose pull
docker compose up -d`}
  />

  <h2>Related</h2>

  <ul>
    <li><a href="/docs/installation">Installation</a> - Full setup guide</li>
    <li><a href="/docs/guides/nginx">Nginx Guide</a> - Reverse proxy setup</li>
  </ul>
</DocsLayout>
